- name: Set up repository
  ansible.builtin.include_role:
    name: debian_ppa
  vars:
    ppa_owner: egor-tensin
    ppa_name: linux-status
    ppa_distro: focal
    ppa_key: ecb69cbafc6d7cd8bd67ec35b1089b3051c9384d

- name: Install linux-status
  become: true
  ansible.builtin.apt:
    install_recommends: false
    name: linux-status

- name: Disable power management
  when: linux_status_disable_power_management
  ansible.builtin.include_role:
    name: systemd_edit
  vars:
    service_name: linux-status
    service_section: Service
    service_option: ExecStart
    service_values: ['', '/usr/bin/python3 -B server.py --disable-power']
